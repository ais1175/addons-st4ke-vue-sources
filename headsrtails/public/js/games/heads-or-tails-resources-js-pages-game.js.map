{"version":3,"sources":["webpack:///./packages/heads-or-tails/resources/js/pages/game.vue?5a3e","webpack:///./packages/heads-or-tails/resources/audio/lose.wav","webpack:///./packages/heads-or-tails/resources/js/pages/game.vue?d99a","webpack:///./packages/heads-or-tails/resources/audio/hit1.wav","webpack:///resources/js/mixins/Game.vue","webpack:///./resources/js/mixins/Game.vue?b66b","webpack:///./resources/js/plugins/route.js","webpack:///./resources/js/mixins/Game.vue","webpack:///./resources/audio/common/click.wav","webpack:///./packages/heads-or-tails/resources/audio/win.wav","webpack:///./packages/heads-or-tails/resources/js/pages/game.vue?dda6","webpack:///packages/heads-or-tails/resources/js/pages/game.vue","webpack:///./packages/heads-or-tails/resources/js/pages/game.vue?fee7","webpack:///./packages/heads-or-tails/resources/js/pages/game.vue","webpack:///./packages/heads-or-tails/resources/audio/hit2.wav","webpack:///./packages/heads-or-tails/resources/js/pages/game.vue?6a15"],"names":["content","module","i","options","transform","undefined","locals","exports","computed","gamePackageId","this","$route","params","game","provablyFairGame","$store","getters","methods","getRoute","name","store","component","render","staticRenderFns","components","mixins","Form","data","clickSound","winSound","loseSound","hit1Sound","hit2Sound","formIsValid","loading","playing","is_ready","tossBet","tossResult","result","message","animation","houseEdge","headsImageUrl","tailsImageUrl","edgeImageUrl","cameraAngle","cameraPosition","throwHeight","beforeDestroy","animate","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","ref","model","value","callback","$$v","expression","on","$event","sound","_s","$t","play","VBtn","VBtnToggle","push"],"mappings":"kFACA,IAAIA,EAAU,EAAQ,QAEA,iBAAZA,IAAsBA,EAAU,CAAC,CAACC,EAAOC,EAAIF,EAAS,MAOhE,IAAIG,EAAU,CAAC,KAAM,EAErB,eAPIC,EAQJ,gBAAqBC,GAER,EAAQ,OAAR,CAAsEL,EAASG,GAEzFH,EAAQM,SAAQL,EAAOM,QAAUP,EAAQM,S,qBCjB5CL,EAAOM,QAAU,IAA0B,iC,kCCA3C,uBAAgiB,G,qBCAhiBN,EAAOM,QAAU,IAA0B,iC,kDCG3C,ICHkQ,EDGlQ,CACEC,SAAU,CACRC,cADJ,WAEM,OAAOC,KAAKC,OAAOC,OAAOC,MAE5BC,iBAJJ,WAKM,OAAOJ,KAAKK,OAAOC,QAAQ,qBAAqBN,KAAKD,gBAAkB,KAI3EQ,QAAS,CACPC,SADJ,SACA,GACM,OEbiBC,EFaJ,SAAnB,yCEZSC,IAAMJ,QAAQ,aAAaG,GAD7B,IAAgBA,K,YCKnBE,EAAY,YACd,OAREC,OAAQC,GAWV,EACA,KACA,KACA,MAIa,IAAAF,E,8BClBfpB,EAAOM,QAAU,IAA0B,0B,qBCA3CN,EAAOM,QAAU,IAA0B,gC,yCCA3C,I,8vCC8DA,IA8SA,EA9SA,EC9DoR,ED8DpR,CACEY,KAAM,eAENK,WAAY,CAAd,Y,UAAA,oBAEEC,OAAQ,CAACC,EAAX,WAEEC,KAPF,WAQI,MAAO,CACLC,WAAN,IACMC,SAAN,IACMC,UAAN,IACMC,UAAN,IACMC,UAAN,IACMC,aAAa,EACbC,SAAS,EACTC,SAAS,EACTC,UAAU,EACVC,QAAS,EACTC,WAAY,KACZC,OAAQ,KACRC,QAAS,KACTC,UAAW,KAIfjC,SAAU,EAAZ,GACA,gCADA,CAEIkC,UAFJ,WAGM,OAAO,OAAb,IAAa,CAAb,8BAEIC,cALJ,WAMM,OAAO,OAAb,IAAa,CAAb,gCAEIC,cARJ,WASM,OAAO,OAAb,IAAa,CAAb,gCAEIC,aAXJ,WAYM,OAAO,OAAb,IAAa,CAAb,+BAEIC,YAdJ,WAeM,OAAO,OAAb,IAAa,CAAb,0CAEIC,eAjBJ,WAkBM,OAAO,OAAb,IAAa,CAAb,6CAEIC,YApBJ,WAqBM,OAAO,OAAb,IAAa,CAAb,4CAGE,SAlDF,oIAmDA,gBACA,gBACA,SACA,cACA,eACA,WACA,YACA,cACA,WACA,aACA,cACA,uCACA,yCACA,0EACA,8BACA,oBACA,SACA,QACA,gBACA,YACA,eACA,UACA,eACA,cACA,eACA,cACA,iBACA,sBACA,yBACA,uBACA,YACA,UACA,mBACA,yBACA,qDACA,uFACA,2FACA,4GACA,+CACA,qBACA,mDAEA,8BAEA,6CACA,wBACA,2BACA,4BACA,sBACA,wBACA,0BACA,cACA,eAGA,kEACA,+DACA,mEACA,6CAGA,6BACA,wHACA,gDACA,yEACA,sDACA,yDACA,2CACA,gFACA,6CACA,2CACA,8CACA,yEAEA,wBACA,6BAEA,yBACA,gBACA,iBACA,iBACA,6BAEA,yBACA,cACA,6BACA,gBACA,wBACA,wBACA,4BACA,6BACA,4BAEA,0HACA,kFACA,iCACA,4CACA,sDACA,0CAEA,+CACA,gDACA,kDACA,wCACA,wHAEA,wCACA,0HAGA,0GACA,mFACA,oDAIA,sFACA,wDACA,mBAHA,IAGA,gCACA,6BACA,sFACA,iDACA,oBAPA,IAOA,gCACA,4BACA,iBACA,iBACA,sFACA,0DACA,eAbA,IAaA,kCACA,6BACA,sFACA,yDACA,gBAjBA,IAiBA,kCACA,4BAEA,cACA,qCACA,kCACA,oEAKA,OAJA,UACA,WACA,mBACA,qBACA,GAlMA,UAoMA,2BACA,gBACA,oCACA,YACA,yBAxMA,eAoMA,gCApMA,iBA0MA,2BACA,gBACA,oCACA,YACA,yBA9MA,eA0MA,mCA1MA,iBAgNA,2BACA,gBACA,oCACA,YACA,wBApNA,QAgNA,iCAhNA,OAsNA,4BACA,sGACA,6CACA,eACA,mBACA,eACA,2BACA,0CACA,cACA,wEACA,2CACA,0EACA,iBACA,uBACA,kCACA,0DACA,2CACA,2CACA,8EACA,2CACA,0EACA,iBACA,uBACA,qCACA,8DACA,6CACA,+CAEA,2BACA,8CACA,oMACA,0CACA,4CACA,oBACA,+CACA,oBACA,2DACA,iCACA,sDACA,iGACA,2CACA,sBACA,SACA,mBACA,oDAEA,IADA,QACA,MACA,yBACA,gDACA,oDACA,eAEA,KACA,6BACA,6BACA,IAEA,uDACA,4BACA,+DACA,6CACA,2BAEA,kCACA,qBACA,iBAEA,OADA,oDACA,cAEA,qCACA,IACA,wCACA,iCACA,OACA,cAJA,IAKA,cALA,IAMA,cANA,IAOA,cAPA,IAQA,cARA,IASA,cATA,IAWA,mDACA,yBACA,iBAzSA,6FA2SEC,cA3SF,WA4SIvC,KAAK+B,UAAUS,QAAU,cAE3BjC,QAAS,EAAX,GACA,aACI,yBAAJ,gCACI,oBAAJ,sBAHA,CAKI,MALJ,yBAKA,GALA,oFAMA,gBACA,gBACA,kBAGA,sDAXA,SAaA,gBAbA,cAgBA,wBACA,gEAjBA,UAoBA,cApBA,iBAoBA,EApBA,EAoBA,KACA,gBACA,aACA,0BACA,UACA,aACA,YAEA,SACA,sBACA,0EAEA,sBACA,gEAGA,uCACA,sCACA,kEAtCA,iG,qEEpWII,EAAY,YACd,GHTW,WAAa,IAAI8B,EAAIzC,KAAS0C,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,uCAAuC,CAACF,EAAG,MAAM,CAACE,YAAY,wDAAwD,CAACF,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,eAAe,CAACG,MAAM,CAAC,QAAUN,EAAIX,YAAY,KAAKW,EAAIO,GAAG,KAAKJ,EAAG,MAAM,CAACE,YAAY,kDAAkD,CAACF,EAAG,MAAM,CAACK,IAAI,YAAYH,YAAY,gBAAgBL,EAAIO,GAAG,KAAKJ,EAAG,MAAM,CAACE,YAAY,qCAAqC,CAACF,EAAG,eAAe,CAACE,YAAY,yBAAyBC,MAAM,CAAC,eAAe,gBAAgB,UAAY,GAAG,QAAU,GAAG,MAAQ,IAAIG,MAAM,CAACC,MAAOV,EAAW,QAAEW,SAAS,SAAUC,GAAMZ,EAAId,QAAQ0B,GAAKC,WAAW,YAAY,CAACV,EAAG,QAAQ,CAACE,YAAY,OAAOC,MAAM,CAAC,SAAWN,EAAIhB,UAAYgB,EAAIf,SAAS,MAAQ,GAAG,MAAQ,GAAG6B,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOf,EAAIgB,MAAMhB,EAAIvB,eAAe,CAACuB,EAAIO,GAAG,aAAaP,EAAIiB,GAAGjB,EAAIkB,GAAG,UAAU,cAAclB,EAAIO,GAAG,KAAKJ,EAAG,QAAQ,CAACE,YAAY,OAAOC,MAAM,CAAC,SAAWN,EAAIhB,UAAYgB,EAAIf,SAAS,MAAQ,GAAG,MAAQ,GAAG6B,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOf,EAAIgB,MAAMhB,EAAIvB,eAAe,CAACuB,EAAIO,GAAG,aAAaP,EAAIiB,GAAGjB,EAAIkB,GAAG,UAAU,eAAe,IAAI,GAAGlB,EAAIO,GAAG,KAAKJ,EAAG,gBAAgB,CAACG,MAAM,CAAC,QAAUN,EAAIjB,QAAQ,QAAUiB,EAAIhB,QAAQ,UAAYgB,EAAIlB,cAAgBkB,EAAIf,UAAU6B,GAAG,CAAC,KAAOd,EAAImB,SAAS,KACr1C,IGWpB,EACA,KACA,WACA,MAIa,UAAAjD,EAAiB,QAMhC,IAAkBA,EAAW,CAACkD,OAAA,EAAKC,aAAA,K,qBCzBnCvE,EAAOM,QAAU,IAA0B,iC,sBCAjCN,EAAOM,QAAU,EAAQ,OAAR,EAAkE,IAKrFkE,KAAK,CAACxE,EAAOC,EAAI,8ZAA+Z","file":"js/games/heads-or-tails-resources-js-pages-game.js","sourcesContent":["\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--6-3!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--6-3!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--6-3!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","module.exports = __webpack_public_path__ + \"audio/heads-or-tails/lose.wav\";","import mod from \"-!../../../../../node_modules/style-loader/index.js!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--6-3!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../node_modules/style-loader/index.js!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--6-3!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"audio/heads-or-tails/hit1.wav\";","<script>\nimport { route } from '~/plugins/route'\n\nexport default {\n  computed: {\n    gamePackageId () {\n      return this.$route.params.game\n    },\n    provablyFairGame () {\n      return this.$store.getters['provably-fair/get'](this.gamePackageId) || {}\n    }\n  },\n\n  methods: {\n    getRoute (action) {\n      return route(`games.${this.gamePackageId}.${action}`)\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Game.vue?vue&type=script&lang=js&\"","import store from '~/store'\n\nexport function route (name) {\n  return store.getters['route/get'](name)\n}\n","var render, staticRenderFns\nimport script from \"./Game.vue?vue&type=script&lang=js&\"\nexport * from \"./Game.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"audio/common/click.wav\";","module.exports = __webpack_public_path__ + \"audio/heads-or-tails/win.wav\";","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"d-flex flex-column fill-height py-3\"},[_c('div',{staticClass:\"message-container d-flex justify-center align-center\"},[_c('div',{staticClass:\"message\"},[_c('game-message',{attrs:{\"message\":_vm.message}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"d-flex justify-center fill-height align-center\"},[_c('div',{ref:\"animation\",staticClass:\"animation\"})]),_vm._v(\" \"),_c('div',{staticClass:\"d-flex justify-center flex-column\"},[_c('v-btn-toggle',{staticClass:\"align-self-center mb-3\",attrs:{\"active-class\":\"primary--text\",\"mandatory\":\"\",\"rounded\":\"\",\"group\":\"\"},model:{value:(_vm.tossBet),callback:function ($$v) {_vm.tossBet=$$v},expression:\"tossBet\"}},[_c('v-btn',{staticClass:\"mx-1\",attrs:{\"disabled\":_vm.playing || !_vm.is_ready,\"small\":\"\",\"value\":0},on:{\"click\":function($event){return _vm.sound(_vm.clickSound)}}},[_vm._v(\"\\n        \"+_vm._s(_vm.$t('Heads'))+\"\\n      \")]),_vm._v(\" \"),_c('v-btn',{staticClass:\"mx-1\",attrs:{\"disabled\":_vm.playing || !_vm.is_ready,\"small\":\"\",\"value\":1},on:{\"click\":function($event){return _vm.sound(_vm.clickSound)}}},[_vm._v(\"\\n        \"+_vm._s(_vm.$t('Tails'))+\"\\n      \")])],1)],1),_vm._v(\" \"),_c('play-controls',{attrs:{\"loading\":_vm.loading,\"playing\":_vm.playing,\"disabled\":!_vm.formIsValid || !_vm.is_ready},on:{\"play\":_vm.play}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"d-flex flex-column fill-height py-3\">\n    <div class=\"message-container d-flex justify-center align-center\">\n      <div class=\"message\">\n        <game-message :message=\"message\" />\n      </div>\n    </div>\n    <div class=\"d-flex justify-center fill-height align-center\">\n      <div ref=\"animation\" class=\"animation\" />\n    </div>\n    <div class=\"d-flex justify-center flex-column\">\n      <v-btn-toggle\n        v-model=\"tossBet\"\n        active-class=\"primary--text\"\n        mandatory\n        rounded\n        group\n        class=\"align-self-center mb-3\"\n      >\n        <v-btn\n          :disabled=\"playing || !is_ready\"\n          class=\"mx-1\"\n          small\n          :value=\"0\"\n          @click=\"sound(clickSound)\"\n        >\n          {{ $t('Heads') }}\n        </v-btn>\n        <v-btn\n          :disabled=\"playing || !is_ready\"\n          class=\"mx-1\"\n          small\n          :value=\"1\"\n          @click=\"sound(clickSound)\"\n        >\n          {{ $t('Tails') }}\n        </v-btn>\n      </v-btn-toggle>\n    </div>\n    <play-controls :loading=\"loading\" :playing=\"playing\" :disabled=\"!formIsValid || !is_ready\" @play=\"play\" />\n  </div>\n</template>\n\n<script>\nimport * as CANNON from 'cannon'\nimport * as THREE from 'three'\nimport axios from 'axios'\nimport { mapState, mapActions } from 'vuex'\nimport { config } from '~/plugins/config'\nimport { decimal } from '~/plugins/format'\nimport FormMixin from '~/mixins/Form'\nimport GameMixin from '~/mixins/Game'\nimport SoundMixin from '~/mixins/Sound'\nimport { sleep } from '~/plugins/utils'\nimport clickSound from '~/../audio/common/click.wav'\nimport winSound from 'packages/heads-or-tails/resources/audio/win.wav'\nimport loseSound from 'packages/heads-or-tails/resources/audio/lose.wav'\nimport hit1Sound from 'packages/heads-or-tails/resources/audio/hit1.wav'\nimport hit2Sound from 'packages/heads-or-tails/resources/audio/hit2.wav'\nimport PlayControls from '~/components/Games/PlayControls'\nimport GameMessage from '~/components/Games/GameMessage'\n\nexport default {\n  name: 'HeadsOrTails',\n\n  components: { GameMessage, PlayControls },\n\n  mixins: [FormMixin, GameMixin, SoundMixin],\n\n  data () {\n    return {\n      clickSound,\n      winSound,\n      loseSound,\n      hit1Sound,\n      hit2Sound,\n      formIsValid: true,\n      loading: false,\n      playing: false,\n      is_ready: false,\n      tossBet: 0,\n      tossResult: null,\n      result: null,\n      message: null,\n      animation: {}\n    }\n  },\n\n  computed: {\n    ...mapState('auth', ['account']),\n    houseEdge () {\n      return config('heads-or-tails.house_edge')\n    },\n    headsImageUrl () {\n      return config('heads-or-tails.images.heads')\n    },\n    tailsImageUrl () {\n      return config('heads-or-tails.images.tails')\n    },\n    edgeImageUrl () {\n      return config('heads-or-tails.images.edge')\n    },\n    cameraAngle () {\n      return config('heads-or-tails.animation.camera_angle')\n    },\n    cameraPosition () {\n      return config('heads-or-tails.animation.camera_position')\n    },\n    throwHeight () {\n      return config('heads-or-tails.animation.throw_height')\n    }\n  },\n  async mounted () {\n    window.hot = this\n    this.animation = {\n      pos: null,\n      velocity: null,\n      container: null,\n      scene: null,\n      camera: null,\n      renderer: null,\n      world: null,\n      floorWidth: 0,\n      floorHeight: 0,\n      width: this.$refs.animation.offsetWidth,\n      height: this.$refs.animation.offsetHeight,\n      aspect: this.$refs.animation.offsetWidth / this.$refs.animation.offsetHeight,\n      camera_angle: this.cameraAngle,\n      camera_position: 100,\n      near: 0.01,\n      far: 10000,\n      animationStep: 0,\n      lastSound: 0,\n      isAnimation: false,\n      coin: null,\n      coin_body: null,\n      coin_radius: 5,\n      coin_height: 0.3,\n      coin_top: null,\n      coin_bottom: null,\n      coin_top_texture: null,\n      coin_bottom_texture: null,\n      coin_side_texture: null,\n      result: null,\n      frames: [],\n      animate: () => {\n        if (this.animation.isThrought) {\n          if (this.animation.frames.length > this.animation.animationStep) {\n            this.animation.coin.position.copy(this.animation.frames[this.animation.animationStep].position)\n            this.animation.coin.quaternion.copy(this.animation.frames[this.animation.animationStep].quaternion)\n            if (this.animation.frames[this.animation.animationStep].is_contact && this.animation.lastSound < this.animation.animationStep) {\n              if (this.animation.lastSound === 0) this.sound(this.hit1Sound)\n              else this.sound(this.hit2Sound)\n              this.animation.lastSound = this.animation.animationStep + 5\n            }\n            this.animation.animationStep++\n          } else {\n            this.updateUserAccountBalance(this.result.balance)\n            this.sound(this.result.sound)\n            this.message = this.result.message\n            this.animation.animationStep = 0\n            this.animation.frames = []\n            this.animation.lastSound = 0\n            this.animation.isThrought = false\n            this.result = null\n            this.playing = false\n          }\n        }\n        this.animation.renderer.render(this.animation.scene, this.animation.camera)\n        this.animation.coin.position.copy(this.animation.coin_body.position)\n        this.animation.coin.quaternion.copy(this.animation.coin_body.quaternion)\n        requestAnimationFrame(this.animation.animate)\n      }\n    }\n    this.animation.scene = new THREE.Scene()\n    this.animation.camera = new THREE.PerspectiveCamera(this.animation.camera_angle, this.animation.aspect, this.animation.near, this.animation.far)\n    this.animation.scene.add(this.animation.camera)\n    this.animation.camera.position.set(0, this.animation.camera_position, 100)\n    this.animation.camera.lookAt(0, 0, this.cameraPosition)\n    this.animation.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true })\n    this.animation.renderer.setClearColor(0x000000, 0)\n    this.animation.renderer.setSize(this.animation.width * 2, this.animation.height * 2)\n    this.animation.renderer.shadowMap.enabled = true\n    this.animation.renderer.shadowMap.type = THREE.PCFSoftShadowMap\n    this.animation.container = this.$refs.animation\n    this.animation.container.appendChild(this.animation.renderer.domElement)\n\n    const ambient = new THREE.AmbientLight('#ffffff', 0.5)\n    this.animation.scene.add(ambient)\n\n    const directionalLight = new THREE.DirectionalLight('#ffffff', 0.5)\n    directionalLight.position.x = -1000\n    directionalLight.position.y = 1000\n    directionalLight.position.z = 1000\n    this.animation.scene.add(directionalLight)\n\n    const light = new THREE.SpotLight(0xefdfd5, 0.75)\n    light.position.y = 60\n    light.target.position.set(0, 0, 0)\n    light.castShadow = true\n    light.shadow.camera.near = 50\n    light.shadow.camera.far = 210\n    light.shadow.mapSize.width = 1024\n    light.shadow.mapSize.height = 1024\n    this.animation.scene.add(light)\n\n    this.animation.floorHeight = 2 * Math.tan(this.animation.camera.fov * Math.PI / 180 / 2) * Math.abs(this.animation.camera.position.y)\n    this.animation.floorWidth = this.animation.floorHeight * this.animation.camera.aspect\n    this.animation.world = new CANNON.World()\n    this.animation.world.gravity.set(0, -9.82 * 10, 0)\n    this.animation.world.broadphase = new CANNON.NaiveBroadphase()\n    this.animation.world.solver.iterations = 16\n\n    this.animation.coinBodyMaterial = new CANNON.Material()\n    this.animation.floorBodyMaterial = new CANNON.Material()\n    this.animation.barrierBodyMaterial = new CANNON.Material()\n    this.animation.world.addContactMaterial(\n        new CANNON.ContactMaterial(this.animation.floorBodyMaterial, this.animation.coinBodyMaterial, { friction: 0.001, restitution: 0.5 })\n    )\n    this.animation.world.addContactMaterial(\n        new CANNON.ContactMaterial(this.animation.barrierBodyMaterial, this.animation.coinBodyMaterial, { friction: 0.001, restitution: 0.5 })\n    )\n    // Floor\n    this.animation.floorBody = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: this.animation.floorBodyMaterial })\n    this.animation.floorBody.quaternion.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2)\n    this.animation.world.add(this.animation.floorBody)\n    // Barrier\n    var barrier\n    const barrierCorner = 0.85\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: this.animation.barrierBodyMaterial })\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI)\n    barrier.position.set(0, 0, this.animation.floorHeight * barrierCorner / 2 - 5)\n    this.animation.world.add(barrier)\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: this.animation.barrierBodyMaterial })\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), 0)\n    barrier.position.set(0, 0, -(this.animation.floorHeight * barrierCorner / 2) - 5)\n    this.animation.world.add(barrier)\n    window.barrier = barrier\n    window.CANNON = CANNON\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: this.animation.barrierBodyMaterial })\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2)\n    barrier.position.set(this.animation.floorWidth * barrierCorner / 2, 0, -5)\n    this.animation.world.add(barrier)\n    barrier = new CANNON.Body({ mass: 0, shape: new CANNON.Plane(), material: this.animation.barrierBodyMaterial })\n    barrier.quaternion.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), Math.PI / 2)\n    barrier.position.set(-(this.animation.floorWidth * barrierCorner / 2), 0, -5)\n    this.animation.world.add(barrier)\n    // Coin\n    const resizeImage = (image) => {\n      const width = THREE.Math.floorPowerOfTwo(image.width * 2)\n      const height = THREE.Math.floorPowerOfTwo(image.height * 2)\n      const canvas = document.createElementNS('http://www.w3.org/1999/xhtml', 'canvas')\n      canvas.width = width\n      canvas.height = height\n      const context = canvas.getContext('2d')\n      context.drawImage(image, 0, 0, width, height)\n      return canvas\n    }\n    this.animation.coin_top_texture = await (new Promise((resolve, reject) => {\n          var img = new Image()\n          img.onload = () => resolve(resizeImage(img))\n          img.onerror = reject\n          img.src = this.headsImageUrl\n        }))\n    this.animation.coin_bottom_texture = await (new Promise((resolve, reject) => {\n          var img = new Image()\n          img.onload = () => resolve(resizeImage(img))\n          img.onerror = reject\n          img.src = this.tailsImageUrl\n        }))\n    this.animation.coin_side_texture = await (new Promise((resolve, reject) => {\n          var img = new Image()\n          img.onload = () => resolve(resizeImage(img))\n          img.onerror = reject\n          img.src = this.edgeImageUrl\n        }))\n    this.animation.coin = new THREE.Object3D()\n    const coinSides = new THREE.CylinderGeometry(this.animation.coin_radius, this.animation.coin_radius, this.animation.coin_height, 100, 1, true)\n    const sideTexture = new THREE.Texture(this.animation.coin_side_texture)\n    sideTexture.needsUpdate = true\n    const sidesMat = new THREE.MeshLambertMaterial({ map: sideTexture })\n    const sidesMesh = new THREE.Mesh(coinSides, sidesMat)\n    this.animation.coin.add(sidesMesh)\n    this.animation.coin_swap = (swap) => {\n      if (swap === undefined) swap = false\n      if (this.animation.coin_top !== null) this.animation.coin.add(this.animation.coin_top)\n      const capTopGeo = new THREE.CircleGeometry(this.animation.coin_radius, 100)\n      const capTopTexture = new THREE.Texture(swap ? this.animation.coin_bottom_texture : this.animation.coin_top_texture)\n      capTopTexture.needsUpdate = true\n      const capTopMat = new THREE.MeshLambertMaterial({ map: capTopTexture })\n      this.animation.coin_top = new THREE.Mesh(capTopGeo, capTopMat)\n      this.animation.coin_top.position.y = this.animation.coin_height / 2\n      this.animation.coin_top.rotation.x = -Math.PI / 2\n      this.animation.coin.add(this.animation.coin_top)\n      if (this.animation.coin_bottom !== null) this.animation.coin.add(this.animation.coin_bottom)\n      const capBottomGeo = new THREE.CircleGeometry(this.animation.coin_radius, 100)\n      const capBottomTexture = new THREE.Texture(swap ? this.animation.coin_top_texture : this.animation.coin_bottom_texture)\n      capBottomTexture.needsUpdate = true\n      const capBottomMat = new THREE.MeshLambertMaterial({ map: capBottomTexture })\n      this.animation.coin_bottom = new THREE.Mesh(capBottomGeo, capBottomMat)\n      this.animation.coin_bottom.position.y = -this.animation.coin_height / 2\n      this.animation.coin_bottom.rotation.x = Math.PI / 2\n      this.animation.coin.add(this.animation.coin_bottom)\n    }\n    this.animation.coin_swap()\n    this.animation.scene.add(this.animation.coin)\n    this.animation.coin_body = new CANNON.Body({ mass: 600, shape: new CANNON.Cylinder(this.animation.coin_radius, this.animation.coin_radius, this.animation.coin_height, 100), material: this.animation.coinBodyMaterial })\n    this.animation.coin_body.linearDamping = 0.1\n    this.animation.coin_body.angularDamping = 0.1\n    var quat = new CANNON.Quaternion()\n    quat.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2)\n    var translation = new CANNON.Vec3(0, 0, 0)\n    this.animation.coin_body.shapes[0].transformAllPoints(translation, quat)\n    this.animation.throw = (result) => { // 0 - heads, 1 - tails\n      this.animation.coin_body.velocity.set(0, this.throwHeight, 0)\n      this.animation.coin_body.angularVelocity.set(25 * Math.random() - 25, Math.random(), 25 * Math.random() - 25)\n      this.animation.coin_body.position.set(0, 10, 0)\n      this.animation.frames = []\n      var isContacts = false\n      const collide = () => { isContacts = true }\n      this.animation.floorBody.addEventListener('collide', collide)\n      var stableCount = 0\n      while (stableCount < 10) {\n        this.animation.frames.push({\n          position: this.animation.coin_body.position.clone(),\n          quaternion: this.animation.coin_body.quaternion.clone(),\n          is_contact: isContacts\n        })\n        isContacts = false\n        this.animation.world.step(1.00 / 30.00)\n        if (this.animation.isFinished()) stableCount++\n        else stableCount = 0\n      }\n      this.animation.floorBody.removeEventListener('collide', collide)\n      const side = this.animation.getSide()\n      if (side > Math.PI / 2 * 0.7 && side < Math.PI / 2 * 1.3) return this.animation.throw(result)\n      this.animation.coin_swap(((side < Math.PI / 2) ? 1 : 0) === result)\n      this.animation.isThrought = true\n    }\n    this.animation.getSide = () => {\n      const vectorTop = new THREE.Vector3(0, 1, 0)\n      var vector = new THREE.Vector3(0, 1, 0)\n      vector.applyQuaternion(this.animation.coin_body.quaternion)\n      return vectorTop.angleTo(vector)\n    }\n    this.animation.isFinished = () => {\n        const threshold = 0.5\n        const angularVelocity = this.animation.coin_body.angularVelocity\n        const velocity = this.animation.coin_body.velocity\n        return (\n                    Math.abs(angularVelocity.x) < threshold &&\n                    Math.abs(angularVelocity.y) < threshold &&\n                    Math.abs(angularVelocity.z) < threshold &&\n                    Math.abs(velocity.x) < threshold &&\n                    Math.abs(velocity.y) < threshold &&\n                    Math.abs(velocity.z) < threshold)\n    }\n    this.animation.world.add(this.animation.coin_body)\n    this.animation.animate()\n    this.is_ready = true\n  },\n  beforeDestroy () {\n    this.animation.animate = () => {}\n  },\n  methods: {\n    ...mapActions({\n      updateUserAccountBalance: 'auth/updateUserAccountBalance',\n      setProvablyFairGame: 'provably-fair/set'\n    }),\n    async play (bet) {\n      this.loading = true\n      this.playing = true\n      this.message = null\n\n      // update user balance\n      this.updateUserAccountBalance(this.account.balance - bet)\n\n      await sleep(10)\n\n      // API request params\n      const endpoint = this.getRoute('play')\n      const requestParams = { hash: this.provablyFairGame.hash, bet, toss_bet: this.tossBet }\n\n      // execute the action\n      const { data: game } = await axios.post(endpoint, requestParams)\n      this.loading = false\n      this.result = {\n        balance: game.account.balance,\n        win: game.win,\n        message: null,\n        sound: null\n      }\n      if (game.win > 0) {\n        this.result.sound = winSound\n        this.result.message = game.gameable.result + ', ' + this.$t('you won') + ' ' + game.win\n      } else {\n        this.result.sound = loseSound\n        this.result.message = game.gameable.result + ', ' + this.$t('you lost')\n      }\n      // 0 - heads, 1 - tails\n      this.tossResult = game.gameable.toss_result\n      this.animation.throw(this.tossResult)\n      this.setProvablyFairGame({ key: this.gamePackageId, game: game.pf_game })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .animation {\n    width:100%;\n    max-width:1200px;\n    height:350px;\n    &::v-deep canvas {\n      width: 100% !important;\n      height: auto !important;\n    }\n  }\n  .message-container {\n    position:relative;\n    height:0;\n    z-index:2;\n    .message {\n      position:absolute;\n      top:5px;\n      left:50%;\n      transform: translateX(-50%);\n    }\n  }\n</style>\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--4-0!../../../../../node_modules/vuetify-loader/lib/loader.js??ref--11-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./game.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./game.vue?vue&type=template&id=0836ac5e&scoped=true&\"\nimport script from \"./game.vue?vue&type=script&lang=js&\"\nexport * from \"./game.vue?vue&type=script&lang=js&\"\nimport style0 from \"./game.vue?vue&type=style&index=0&id=0836ac5e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0836ac5e\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../../../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VBtnToggle } from 'vuetify/lib/components/VBtnToggle';\ninstallComponents(component, {VBtn,VBtnToggle})\n","module.exports = __webpack_public_path__ + \"audio/heads-or-tails/hit2.wav\";","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".animation[data-v-0836ac5e] {\\n  width: 100%;\\n  max-width: 1200px;\\n  height: 350px;\\n}\\n.animation[data-v-0836ac5e] canvas {\\n  width: 100% !important;\\n  height: auto !important;\\n}\\n.message-container[data-v-0836ac5e] {\\n  position: relative;\\n  height: 0;\\n  z-index: 2;\\n}\\n.message-container .message[data-v-0836ac5e] {\\n  position: absolute;\\n  top: 5px;\\n  left: 50%;\\n  transform: translateX(-50%);\\n}\", \"\"]);\n\n// exports\n"],"sourceRoot":""}